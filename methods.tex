\section{Methods and working hypotheses}\label{S_methods}
%{{{

Simulations are suitable tools to analyze systems that evolve with
time and involve randomness.
%
An advantadge of simulations compared to theoretical approaches, is
that the former usually require less assumptions and simplifications,
and can be applied to systems where a theoretical model can not be
found.
%
In particular, many complex stochastic processes that can be described
by the evolution of the state of a system, can be efficiently modeled
with the discrete--event (hereafter, DE) simulation approach.
%
A system described with the DE paradigm is characterized by a set of
actors and events, where actors interact causally through a series of
events on a timeline and process these events in chronological order
\citep{ptolemaeus_system_2014, chung_simulation_2003,
ross_simulation_2012}.
%
Each event produces changes in the values of the variables that define
the process, and thus the corresponding change in the state of the
simulated system.
%
This method is well suited for the particular case of the difusion of
intelligent signals in the Galaxy, and allows to explore several
models easily.
%
We simulate the statistical properties of a set of points in space and
time that have the ability of emitting and communicating messages at
light speed, hereafter dubbed ''message processing locations'' (MPL).
%
These locations have the capability of emitting and receiving messages
in all directions.
%
It is worth mentioning that this is a general approach, and not
necessarily a MPL is the host of an intelligent civilization.
%
It can be associated with a set of planets where life has developed,
became intelligent, reached the skills required to find the right
communication channel, sustain a search and stablish a contact.
%
Alternative message processing entities could be considered, for
example interstellar beacons where life has ceased to exist but
continue with its emission or communication stations stablished by
probes or left intentionally by intelligent beings \citep[see, e.g.,
][]{peters_outer_2018, barlow_galactic_2013}.
%
In principle, these strategies could affect our results since it would
be easier to configure a cluster of MPLs that spread in time.
%
However, we do not consider this highly speculative alternatives at
this point.
%
% have been proposed
%
For the purpose of this analysis, only the communication capability is
relevant, since we study the causal contacts between the locations.
%
% communicating, civilization, intelligent, message, processing,
% handling, locations CALL, MPI, MPL, MPL
%
The system is defined by a number of actors that represent MPLs and
appear at different instants in time, generating events that produce
meaningful changes in the variables that describe the system, i.e., in
the arrangement of MPLs and their network of causal contacts.
%
For example, the appeareance of a new MPL in a region which is filled
with a signal emitted by another MPL, will increase the number of
active MPLs and the number of pairs of MPLs in causal contact.
%
Assuming some simple hypotheses, the discrete events method can be
performed taking into account a small number of variables, which allow
to analyze the variation of the results in the model parameter space.


In what follows, we describe the experimental setup chosen to estimate
the probabilities of causal contacts and several derived quantities in
terms of three independent parameters, namely, the mean time span
between the appeareance of consecutive MPLs, ($<\tau_a>$), their mean
lifetime ($<\tau_s>$), and the maximum distance a signal can be
detected by another MPL ($D_{max}$).
%
Intuitively, the shorter the $\tau_a$ parameter and the larger the
$\tau_s$ and $D_{max}$ parameters are, the greater the probability of
the existence of causal contacts between pairs of MPLs would be.
%
We also need to propose theoretical distribution functions for both
the distribution of lifespans ($\tau_s$) and the distribution of the
number of MPLs per unit time \citep{maccone_evolution_2014,
Sotos_biotechnology_2019}, related to the time span between the
appeareance of consecutive MPLs (since when $<\tau_a>$ is shorter, it
produces a greater density of MPLs).
%
The shapes of these distributions are set to a fixed law, as discussed
in Sec.~\ref{SS_PDF_shape}.


A causal connection can be produced without the need of the two
involved locations being concurrent or active at the same time.
%
This is a fundamental property of the system which arises as a
consecuence of the large spatial and temporal scales, where a message
is transmited at light speed.
%
Although a MPL could be active for enough time so as to transmit a
message at large distances, the limited power of the message and the
dilution that runs as the squared distance from the source, imposes a
detectability limit.
%
As a consecuence of this limitation and of their finite lifetime,
considered as the period of time between the aquisition and loss of
communicating capacity, each MPL will fill a spherical shell region of
the Galaxy, limited by two concentric spherical surfaces.
%
The leading front, or surface of first contact (SFC) grows from the
central MPL until it reaches the maximum distance $D_{max}$.
%
Thus, the volume reached causally by a MPL is initially a growing
sphere.
%
Following the end of the civilization, there is still a region which
is filled with the emited signals.
%
The trailing front, or surface of last contact (SLC) also grows from
the central MPL, with a delay with respect to the SFC equivalent to
the lifetime of the MPL, and produces a spherical shell region.
%
Any other MPL within this region will be aware of the originating MPL,
even if it has disapeared before the time of contact.
%
This region will grow if the surface of first contact has not yet
reached the maximum distance $D_{max}$, and will shrink otherwise
until the surface of last contact reaches $D_{max}$, producing as a
result the loss of all signal from the central MPL.
%
In our approach, we consider a model Galaxy where the width of the
disk is negligigle with respect to the radius of the disk, so that the
MPLs are placed on a 2D plane disk.
%
In the 2D simulation only the intersection of the communicating
spherical shells with the plane of the galaxy is relevant, and produce
the corresponding circles or rings for the filled spheres or annular
regions of the spherical shells, respectively.
%
We illustrate in the Fig.~\ref{F_scheme} the schematic representation
of the region causally connected to the central MPL.
%
To this end, we use space--time diagrams, where time is represented on
the horizontal axis, and space is represented in the vertical axis.
%
A growing surface of first contact in this diagram is represented as a
growing circle, centered on a point in the time axis, which shifts
towards the right at the same rate the radius of the circle increases.
%
The maximum distance of the message limits the radius of the circles,
so that once this distance is reached, the circle continues its shift
towards the right, but maintaining a constant radius.
%
At the end of the lifetime of a MPL, a growing surface of last
contact is represented by a circle that covers the inner part of the
causal region, producing a ring of diminishig area (panel (a)).
%
In this scheme, the entire lifetime of a MPL can then be represented
by a polygon, limited in the spatial axis by the maximum distance of
the signal $D_{max}$ and in the time axis by the time span between the
starting time (concave vertex) and the ending time (convex vertex).
%
This representation allows to easily visualize the important events
that result from the existence and communications of two MPLs (panel
(b)).
%
The points in time where the MPLs aquire their communicating capacity
(CC) are dubbed ''awakening'' events ($A_1$ and $A_2$ in the Figure).
%
Simmilarly, the points in time where the MPLs loss their
communicating capacity are dubbed ''doomsday'' events ($D_1$ and $D_2$
in the Figure).
%
The points in space--time where the first contact is produced for each
one of the MPLs, are defined as ''contact'' events, shown as $C_1$
and $C_2$ in the Figure.
%
Finally, the two points where the contact is lost for each one the
MPLs, are denominated ''blackout'' events, shown as $B_1$ and $B_2$
in the Figure.
%
It is important to notice that there is a time delay between the
contact events of the two MPLs involved in this analysis, and also a
time delay between the two blackout events, so that the time range
when a bidirectional contact is possible occurs between the maximum
time of the contact points and the minimum time between the blackout
points.




The initially growing communicating sphere, is shown over
space--time diagrams, where time is represented on the horizontal
direction, and space is represented in the vertical direction.
%
In the upper panel (a), the sphere is growing as the surface of first
contact has not reached the maximum distance.
%
In the middle panel (b) it has reached the maximum distance, so that
it remains at the same size.
%
After a Doomsday event (bottom panel, b), the signals can still be
observed, but the surface of last contact grows.
%
We also show in this Figure a schematic representation of two
emitters, E$_1$ and E$_2$, that reach each other at different times.
%
The time span for E$_i$ is (A$_i$ , D$_i$) , for $i = {1, 2}$.
%
Emitter $i$ can listen to emitter $j$ between C$_{ij}$ and B$_{ij}$.
%
The type and length of causal contact in both directions depend on the
distance and time lag between the awakening events, the maximum
distance that a signal can reach and the time period in which each
emitter is active.
%
In the Fig.~\ref{F_messages} we show a schematic representation of the
possible cases in which a MPL A can be in causal contact with a MPL
B which appears later.
%
The duration of the causal contact in one direction depends on several
factors, mainly $\Delta$t~A , $\Delta$t~C , and $\Delta$X.

\begin{figure}
   \centering
   \includegraphics[width=0.5\textwidth]{scheme.pdf}
   \usecaption{F_scheme} \label{F_scheme}
\end{figure}

The temporal structure of the process is defined by two distribution
parameters that represent the mean time interval that an intelligent
civilization can emit and receive signals, and the mean time interval
between the emergence of an intelligent comunicating civilization and
the next one.
%
The spatial structure of the simulation is given by the size and shape
of the Galactic Habitable Zone and the maximum distance a signal can
travel to be detected.
%
The parameters for the temporal distributions also determine the
spatial properties since the density of active cetis in the Galaxy
depend on these two parameters.
%
For example, a small $\tau_a$ and a large $\tau_s$ will produce a
Galaxy densely populated with MPLs, and viceversa.
%
Also, some hypotheses must be made in order to complete the
simulation.
%
\citet{forgan_spatiotemporal_2011} argues that the times at which
different civilizations become intelligent 
follow a Gaussian distribution, and then the distribution of
inter-arrival times is an inverse exponential.
%
We chose to assume that the distribution of the times of A events is a
stationary Poisson process, and then the distribution of the times between the
appeareance of new consecutive MPLs is exponential.
%
Regarding the duration of a MPL, we propose that the distribution of
the duration of MPLs is a stationary exponential distribution.
%
\citet{balbi_impact_2018} stress the fact that it would be desirable to arrive
at a theoretical statistical distribution of the lifespan of
civilizations, preferentially on the basis of the underlying
astrophysical and biological processes.
%
\citet{maccone_lognormals_2014} argues that this distribution should be a log normal.
(EXPAND)



There is no a temporal window for the model, i.e., the simulation
starts when the process is already stable, and ends before any
galactic effect could modify or affect of fixed variables.
%
The probability for the rise of a MPL is homogeneous over the GHZ.
%
Although the Galaxy has a well known spiral structure, the assumed
sparcity of civilizations makes this assumption very reasonably.
%
Otherwise, if the distribution of civilizations is not sparce, it
could be the case that the spiral arms would host most of the
civilizations, and contacts are frecuent between closely located
civilizations.
%
In such a case we could expect that the interpretation of our results
could be considered as pesimist for the stablishment of a contact with
our planet.
%
We also limit the posibilities of life or other types of civilizations
to the hypothesis usually stated for the definition of the GHZ
\citep{dayal_habitability_2016,gonzalez_galactic_2001,lineweaver_galactic_2004,gonzalez_habitable_2005,morrison_extending_2015,haqq-misra_evolution_2019,rahvar_cosmic_2016,gobat_evolution_2016,
rahvar_cosmic_2016}.
%
\citet{vukotic_astrobiological_2012} propose probabilistic cellular
automata model to explain the astrobiological history of the Milky
Way.
%
This means that we set aside possible civilizations that could survive
in severe conditions or unstable systems, which would prevent the
appeareance of life as we know it.

 
\setlength{\tabcolsep}{10pt}
\begin{table*}
\centering
\begin{tabular}{clccc}
\hline
   \multicolumn{2}{l}{independent variables} &min&max&Nbins\\
\hline
   $\tau_{a}$ & Mean temporal separation between consecutive awakenings & 4000 y & 200000 y & 50\\ 
   $\tau_{s}$ & Mean lifetime of a MPL                                 & 10000 y & 500000 y& 50\\ 
   D$_{max}$ & Maximum reach of a message  &  \multicolumn{3}{l}{500, 1000, 10000, 20000, 40000, 80000 lyr}  \\
\hline
   \multicolumn{4}{l}{fixed variables and assumptions} &value \\
\hline
   & statistical properties of all MPLs &equally distributed&&\\
   & Point process for the distribution in time & homogeneous &&\\
   f$_s$ & The scan of the sky & fully efficient&&1\\
   f$_p$ & panspermia or colonization &absent&&0\\
   & shape of the Galactic Habitable Zone & 2--dimensional ring &&\\
   R$_{SFC}$   & Inner radius of the GHZ     &&&20000 ly\\
   R$_{SLC}$   & Outer radius of the GHZ     &&&60000 ly\\
   t$_{max}$ & Time span of the simulation  &&&1.e6 y\\
\hline
   \multicolumn{5}{l}{discrete events}\\
\hline
   A & Awakening: a civilization starts a SETI program  &&&\\
   B & Blackout: the end of the communication chanel stops &&&\\
   C & Contact: a new causal contact is produced &&&\\
   D & Doomsday: a civilization ends its communication capabilities&&&\\
\hline

\hline
\end{tabular}
\caption{Definition of independent variables and adopted values for 
   fixed paramenters 
   that are part of the simulation.  Variable parameters define the
   spatial and temporal structure
   of the process and the maximum reach of the messages.}
\label{T_simu_hypotheses}
\end{table*}


While the aforementioned assumptions are basic conditions for most of
the stochastic processes observed in nature, we need to make stronger
assumptions related to the nature of the message.
%
The most simple assumption about the message itself, is that it
travels at light speed.
%
With this, we are considering messages sent through, for example,
electromagnetic radiation or even gravitational radiation, but we set
appart messages sent with mechanical means or physical objects, or
through some unknown technology that violates the known so far laws of
physics.
% 
For the communication of MPLs through messages sent isotropically, we
assume that the capacity to emit signals and to receive signals ocurr
at the same time.
%
This means that the ability to find another civilization develops at
the same time that the ability and intention to emit a signal in all
direction, intented to be detected by an unknown civilization.
%
Although there are several reasons to think that this could not be the
case, at large time scales it can be considered that both abilities
occurr roughly at coincident epochs.
%
Another essential assumption is that all MPLs use the same signal
power, so that there is a maximum distance out to which it can be
detected.
%
It is worth mentioning that we are considering in our experimental
setup a system composed by several emmiters and receivers across the
Galaxy, under the hypothesis proposed before.
%
In such a system we compute probabilities of a MPL making contact
with another MPL, and the results must be interpreted as for a
randomly chosen MPL, given certain conditions of homogeneityon an
ensemble of equivalent galaxies.
%
We stress the fact that we are not centered on the probabilities for
the Earth itselft, but on a generalized MPL.
%
Regarding the extent of the signals, we know that the distance from
which a signal from Earth could be detected using the current
technology is of a few hundreds light years, given that the signal was
sent to a specific direction.


\begin{figure*}
   \centering
   \includegraphics[width=0.8\textwidth]{Messages_01.pdf}
   \usecaption{F_messages} \label{F_messages}
\end{figure*}
                     

%https://setiathome.berkeley.edu/forum_thread.php?id=80585&postid=1833000#1833000]
%https://www.engadget.com/2017/05/25/listening-to-starlight-our-ongoing-search-for-alien-intelligenc/]
%[from https://en.wikipedia.org/wiki/Fermi_paradox]
%
It is straightforward to propose and implement a distribution of
maximum distances, although this would increase the model complexity
at the cost of a larger uncertainty or of another dimension on the
hypothesis space.
%
This proposal is based on a pronoid scenario (REF), and we do not
consider in this work the ocurrence of paranoid or partially paranoid
civilizations.
%
If that would be the case, the results obtained here can be taken as
upper limits.



In our simulations we also assume the simplest situations for the
growth of ETIs.
%
For example, we discard the possibility of stellar colonization
\citep[e.g.][]{newman_galactic_1981, walters_interstellar_1980,
starling_virulence_2013, barlow_galactic_2012, jeong_large_2000, maccone_mathematical_2011}
and assume that the communication aim is performed to
all directions with the same power and the same probability, i.e.,
strongly assume isotropic communication in all cases.
%
More detailed simulations could be produced considering different 
efficiency of communication or detection methods.
%
Also, a mixed paranoid/pronoid population of intelligent civilizations
could be implemented easily.
%
However, in this case we also would complicate the experimental setup,
make the results less evident.
%
The results are independent of the nature of life (organic or
artificial).
%
The lifetime of a civilization can be caused by autodestruction or by
external factors.
%}}}

\subsection{Power laws vs. exponential laws}\label{SS_PDF_shape}
%{{{

The exponential distribution of lifespan and waiting times is
justified by considering that the process of appeareance of life in
the galaxy is homogeneous and stationary.
%
This means that there is no preferred location within the GHZ for the
spontaneos appeareance of life, and that the emergence of a
civilization is independent of the existence of previous civilizations 
in the galaxy.
%            
This is equivalent to proposing a Poisson process for the emergence of
MPLs, since there is a close relation between the number of events in
time or space and the waiting time or separation, respectively.
%
That is, these are two alternative approaches to describing the same
process, a Poisson distribution for the number of events implies an
exponential distribution for their sepations, and viceversa.
%
It should be emphasized that the exponential laws used in this work
are assumed, although instead of analyzing results from a particular
parameter chosen ad--hoc, we explore the hypothesis space and analyze
the impact of the values of these parameters on the results.
%                                                           

The power law and exponential statistical distributions are among the
most common patterns found in natural phenomena.
%
For example, the distribution of the frecuency of words in many
languajes is known to follow a Zipf law (which is a power law).
%
Zipf law also describes population ranks of cities in various
countries, corporation sizes, income rankings, ranks of number of
people watching the same TV channel (Zipf's law entry on Wikipedia).
%
The magnitudes of earthquakes, hurricanes, volcanic eruptions and
floods; the sizes of meteorites or the losses caused by business
interruptions from accidents, are also well described by power laws
(Sornette 2006).
%
The power law behaviour has been observed in a variety of systems,
including for example stock market fluctuations, sizes of computer
files and word frequency in languages \citep{mitzenmacher_brief_2004,
newman_power_2005, simkin_theory_2006}
%
Power laws have also been widely used in biological sciences, e.g., in
analysing connectivity patterns in metabolic networks
\citep{jeong_large_2000} and in the number of species observed per
unit area in ecology \citep{martin_origin_2006, frank_common_2009}.
% 
More examples can be found in the literature
\citep{martin_origin_2006, maccone_KLT_2010, barabasi_scale_2009,
maccone_evolution_2014, maccone_lognormals_2014,
benguigui_classificacion_2016}
 

%}}}

\subsection{Discrete event process}
%{{{

Given a parametric model $M(\tau_a, \tau_s, D_{max})$, which includes
the functional forms of the statistical distributions and fixed values
for the hypotheses, a discrete event simulation is performed by
keeping track of a set of variables that change each time a meaningful
event is produced.
%
The main variables that follow the evolution of the simulation are the
positions of stars, which are sampled randomly within the GHZ, the
time of the awakening of each MPL (A event), and the time of the
vanishing of each MPL (D event).
%
The variables that can be deduced from the previous ones include the
number of MPLs in casual contact with at least another MPL at a given
time, the number of MPLs as a function of time, the number of MPLs
that receive a message at least one time, the number of MPLs that
receive a message at least one time and successfully deliver an answer
and the number distribution of waiting time to receive a message.
%
All these quantities are updated each time one of the four events (A,
B, C, D) is produced.
          
%%% comparar con el stochsatic cellular automata
% ver libro Solving Fermi paradox, sec. 27.3.1

                 
\begin{figure} \centering
   \includegraphics[width=0.5\textwidth]{F1.pdf}
   \usecaption{F_number_of_contacts} \label{F_number_of_contacts}
\end{figure}
   
%}}}

\subsection{Model for MPLs}
%{{{


Since the method is based on events, the first step is to define an
architecture of events, the relationships between them and how events
trigger changes on the state of the system.
%
We consider a simulated system that represents the galactic habitable
zone (GHZ).
%
On a first approach, the GHZ is a 2-dimensional annular region.
%
The adopted values for the GHZ are 20 kly and 60 kly, for the inner
and outer radius, respectively \citep{lineweaver_galactic_2004}.
% ojo, ese paper dice 7-9 kpc, o sea tiene un limite superior mucho
% mas chico...
%
This simple model does not take into accont the variations in stellar
density given by the spiral structure.
%
Although there are several possible approaches, we chose to follow the
evolution of the system according to the following events:

\begin{enumerate}
   \item[(A)] A new MPL appears (Awakening)
   \item[(D)] An old MPL dissappears (Doomsday)
   \item[(C)] A new causal contact is stablished (Contact)
   \item[(B)] An existing causal contact is interrupted (Blackout)
\end{enumerate}

The event of type B is produced when one of the two MPLs halts in its
capability of emmiting and receiving signals.

                                 
\begin{figure*} % 2D color plot
   \centering
   \includegraphics[width=\textwidth]{matrix_1.pdf}
   \usecaption{F_never_contact}
   \label{F_never_contact}
\end{figure*}

  
\begin{figure*} % 2D color plot
   \centering
   \includegraphics[width=\textwidth]{matrix_2.pdf}
   \usecaption{F_C_at_A}
   \label{F_C_at_A}
\end{figure*}
                         

The system is updated each time an event is produced.
%
The time marks for each event (A and D for each MPL and C and B for
each causal contact) are stored as a result of the simulation.
%
Also, the list of active MPLs is obtained as a function of time.
%
Some fixed variables must be set in order to carry out the simulation:
the size of the Galactic Habitable Zone, the mean lifetime of a MPL,
$\tau_s$, the mean waiting time for the appeareance of another MPL,
$\tau_a$, and the maximum distance a message can be detected.



The Galactic Habitable Zone is the only one of the four parameters
that is barely known, is set at fixed values of the inner and outer
radii, radial symetry is assumed, and the with of the galactic disk is
neglected compared to the radial size.
%
The two radii are measured in light years, with the aim to maintain a
single and comprehensive unit for both space and time coordinates. 

The simulation was implemented on a python 3 code, which is publically
available\footnote{https://github.com/mlares/simu\_contact}

%}}}
                   
\begin{figure}
   \centering
   \includegraphics[width=0.5\textwidth]{waiting_s+a_dif_ylog.pdf}
   \usecaption{F_waiting_for_1C}
   \label{F_waiting_for_1C}
\end{figure}

